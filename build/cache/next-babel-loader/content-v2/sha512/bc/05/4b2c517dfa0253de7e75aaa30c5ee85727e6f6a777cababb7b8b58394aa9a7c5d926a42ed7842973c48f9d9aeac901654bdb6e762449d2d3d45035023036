{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport jwt_decode from 'jwt-decode';\nimport axiosClient from '../../../utils/axios-config';\nimport * as types from './authType';\nimport { asyncLocalStorage } from '../../../utils/localStorage';\nimport config from '../../../config';\nexport function userLogin(params) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch) {\n      var res, decoded;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch({\n                type: types.AUTH_LOGIN_REQUEST\n              });\n              _context.prev = 1;\n              _context.next = 4;\n              return axiosClient.post('user/login', params, {\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              });\n\n            case 4:\n              res = _context.sent;\n              decoded = jwt_decode(res.token);\n              console.log(res);\n              dispatch({\n                type: types.AUTH_LOGIN_SUCCESS,\n                payload: decoded\n              });\n              return _context.abrupt(\"return\", res);\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](1);\n              //console.log('error', error);\n              dispatch({\n                type: types.AUTH_LOGIN_FAILURE\n              });\n              return _context.abrupt(\"return\", Promise.reject(_context.t0));\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 11]]);\n    }));\n\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n}\nexport function userSignup(parms) {\n  return /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch) {\n      var res, status;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              dispatch({\n                type: types.AUTH_SIGNUP_REQUEST\n              });\n              _context2.prev = 1;\n              console.log(parms);\n              _context2.next = 5;\n              return axiosClient.post('user/complete-registration', parms, {\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              });\n\n            case 5:\n              res = _context2.sent;\n              // console.log(res)\n              status = res.status;\n\n              if (!(status == 201)) {\n                _context2.next = 12;\n                break;\n              }\n\n              dispatch({\n                type: types.AUTH_SIGNUP_SUCCESS,\n                payload: res.result.name\n              });\n              return _context2.abrupt(\"return\", res.status);\n\n            case 12:\n              dispatch({\n                type: types.AUTH_SIGNUP_FAILURE\n              });\n              return _context2.abrupt(\"return\", Promise.reject(e));\n\n            case 14:\n              _context2.next = 20;\n              break;\n\n            case 16:\n              _context2.prev = 16;\n              _context2.t0 = _context2[\"catch\"](1);\n              dispatch({\n                type: types.AUTH_SIGNUP_FAILURE\n              });\n              return _context2.abrupt(\"return\", Promise.reject(_context2.t0));\n\n            case 20:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 16]]);\n    }));\n\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n}\nexport function saveTokens(_x3) {\n  return _saveTokens.apply(this, arguments);\n}\n\nfunction _saveTokens() {\n  _saveTokens = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(params) {\n    var access_token, decoded, expires_in, type, expires_at;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            //console.log(\"saveTokens params\", params);\n            access_token = params.access_token, decoded = params.decoded;\n            expires_in = decoded.expires_in, type = decoded.type;\n            expires_at = new Date();\n            expires_at.setSeconds(expires_at.getSeconds() + expires_in);\n            _context3.next = 7;\n            return asyncLocalStorage.setItem(config.AUTH_IN, expires_in);\n\n          case 7:\n            _context3.next = 9;\n            return asyncLocalStorage.setItem(config.AUTH_AT, expires_at.getTime());\n\n          case 9:\n            _context3.next = 11;\n            return asyncLocalStorage.setItem(config.AUTH_TOKEN, access_token);\n\n          case 11:\n            _context3.next = 13;\n            return asyncLocalStorage.setItem(config.AUTH_TYPE, type);\n\n          case 13:\n            return _context3.abrupt(\"return\", Promise.resolve(true));\n\n          case 16:\n            _context3.prev = 16;\n            _context3.t0 = _context3[\"catch\"](0);\n            throw _context3.t0;\n\n          case 19:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[0, 16]]);\n  }));\n  return _saveTokens.apply(this, arguments);\n}","map":{"version":3,"sources":["C:/Users/user/Desktop/Skyslit/Web Projects/Freelance/cheffy/src/redux/actions/auth/authAction.js"],"names":["jwt_decode","axiosClient","types","asyncLocalStorage","config","userLogin","params","dispatch","type","AUTH_LOGIN_REQUEST","post","headers","res","decoded","token","console","log","AUTH_LOGIN_SUCCESS","payload","AUTH_LOGIN_FAILURE","Promise","reject","userSignup","parms","AUTH_SIGNUP_REQUEST","status","AUTH_SIGNUP_SUCCESS","result","name","AUTH_SIGNUP_FAILURE","e","saveTokens","access_token","expires_in","expires_at","Date","setSeconds","getSeconds","setItem","AUTH_IN","AUTH_AT","getTime","AUTH_TOKEN","AUTH_TYPE","resolve"],"mappings":"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","sourcesContent":["import jwt_decode from 'jwt-decode';\r\nimport axiosClient from '../../../utils/axios-config';\r\nimport * as types from './authType';\r\nimport { asyncLocalStorage } from '../../../utils/localStorage';\r\nimport config from '../../../config';\r\n\r\nexport function userLogin(params) {\r\n\treturn async (dispatch) => {\r\n\t\tdispatch({ type: types.AUTH_LOGIN_REQUEST });\r\n\t\ttry {\r\n\t\t\tconst res = await axiosClient.post('user/login', params, {\r\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\t});\r\n\t\t\tconst decoded = jwt_decode(res.token);\r\n\t\t\tconsole.log(res);\r\n\t\t\tdispatch({ type: types.AUTH_LOGIN_SUCCESS, payload: decoded });\r\n\t\t\treturn res;\r\n\t\t} catch (error) {\r\n\t\t\t//console.log('error', error);\r\n\t\t\tdispatch({ type: types.AUTH_LOGIN_FAILURE });\r\n\t\t\treturn Promise.reject(error);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport function userSignup(parms) {\r\n\treturn async (dispatch) => {\r\n\t\tdispatch({ type: types.AUTH_SIGNUP_REQUEST });\r\n\t\ttry {\r\n\t\t\tconsole.log(parms);\r\n\t\t\tconst res = await axiosClient.post('user/complete-registration', parms, {\r\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\r\n\t\t\t});\r\n\t\t\t// console.log(res)\r\n\t\t\tconst status = res.status;\r\n\t\t\tif (status == 201) {\r\n\t\t\t\tdispatch({ type: types.AUTH_SIGNUP_SUCCESS, payload: res.result.name });\r\n\t\t\t\treturn res.status;\r\n\t\t\t} else {\r\n\t\t\t\tdispatch({ type: types.AUTH_SIGNUP_FAILURE });\r\n\t\t\t\treturn Promise.reject(e);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tdispatch({ type: types.AUTH_SIGNUP_FAILURE });\r\n\t\t\treturn Promise.reject(e);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport async function saveTokens(params) {\r\n\ttry {\r\n\t\t//console.log(\"saveTokens params\", params);\r\n\t\tconst { access_token, decoded } = params;\r\n\t\tconst { expires_in, type } = decoded;\r\n\t\tconst expires_at = new Date();\r\n\t\texpires_at.setSeconds(expires_at.getSeconds() + expires_in);\r\n\t\tawait asyncLocalStorage.setItem(config.AUTH_IN, expires_in);\r\n\t\tawait asyncLocalStorage.setItem(config.AUTH_AT, expires_at.getTime());\r\n\t\tawait asyncLocalStorage.setItem(config.AUTH_TOKEN, access_token);\r\n\t\tawait asyncLocalStorage.setItem(config.AUTH_TYPE, type);\r\n\t\treturn Promise.resolve(true);\r\n\t} catch (err) {\r\n\t\tthrow err;\r\n\t}\r\n}\r\n"]},"metadata":{},"sourceType":"module"}